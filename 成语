<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HSK6 æˆè¯­å¯¹å¯¹ç¢°</title>
    <style>
        /* åŸºç¡€æ ·å¼ä¸å˜é‡å®šä¹‰ */
        :root {
            --primary: #2563eb; /* ä¸»è‰²è°ƒï¼šè“è‰² */
            --success: #10b981; /* åŒ¹é…æˆåŠŸè‰²ï¼šç»¿è‰² */
            --bg-light: #f8fafc; /* é¡µé¢èƒŒæ™¯è‰² */
            --card-bg: #ffffff; /* å¡ç‰‡èƒŒæ™¯è‰² */
            --text-dark: #1e293b; /* æ–‡å­—æ·±è‰² */
            --text-light: #ffffff; /* æ–‡å­—æµ…è‰² */
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* åŸºç¡€é˜´å½± */
            --transition: all 0.3s ease; /* è¿‡æ¸¡åŠ¨ç”» */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', 'Roboto', sans-serif;
        }

        body {
            background-color: var(--bg-light);
            color: var(--text-dark);
            min-height: 100vh;
            padding: 20px 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* æ¸¸æˆå¤´éƒ¨æ ·å¼ */
        .game-header {
            width: 100%;
            max-width: 800px;
            text-align: center;
            margin-bottom: 20px;
        }

        .game-title {
            color: var(--primary);
            font-size: 1.8rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .game-stats {
            display: flex;
            justify-content: space-around;
            background: var(--card-bg);
            padding: 12px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            margin-bottom: 15px;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1rem;
        }

        .stat-icon {
            font-size: 1.2rem;
            color: var(--primary);
        }

        .game-controls {
            margin-bottom: 20px;
        }

        .reset-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            background: var(--primary);
            color: var(--text-light);
            cursor: pointer;
            font-size: 0.95rem;
            transition: var(--transition);
        }

        .reset-btn:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
        }

        /* å¡ç‰‡ç½‘æ ¼æ ·å¼ */
        .game-container {
            width: 100%;
            max-width: 800px;
            perspective: 1200px; /* 3Dç¿»è½¬è§†è§’åŸºç¡€ */
        }

        .card-grid {
            display: grid;
            /* è‡ªé€‚åº”åˆ—æ•°ï¼šæœ€å°120px/åˆ—ï¼Œæœ€å¤š6åˆ—ï¼Œè‡ªåŠ¨å¡«å…… */
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 12px;
        }

        /* ç§»åŠ¨ç«¯é€‚é…ï¼šç¼©å°å¡ç‰‡å°ºå¯¸å’Œé—´è· */
        @media (max-width: 768px) {
            .card-grid {
                grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
                gap: 8px;
            }
        }

        /* å¡ç‰‡æ ¸å¿ƒæ ·å¼ï¼ˆå«3Dç¿»è½¬ï¼‰ */
        .card {
            position: relative;
            height: 100px;
            cursor: pointer;
            transform-style: preserve-3d; /* å¼€å¯3Dç©ºé—´ */
            transition: transform 0.5s ease; /* ç¿»è½¬åŠ¨ç”» */
            border-radius: 8px;
            box-shadow: var(--shadow);
            outline: none;
            border: 2px solid transparent;
        }

        /* ç§»åŠ¨ç«¯å¡ç‰‡é«˜åº¦é€‚é… */
        @media (max-width: 768px) {
            .card {
                height: 80px;
            }
        }

        /* å¡ç‰‡èšç„¦æ ·å¼ï¼ˆæ— éšœç¢æ”¯æŒï¼‰ */
        .card:focus {
            border-color: var(--primary);
        }

        /* å¡ç‰‡ç¿»è½¬çŠ¶æ€ */
        .card.flipped {
            transform: rotateY(180deg); /* Yè½´ç¿»è½¬180åº¦ */
        }

        /* åŒ¹é…æˆåŠŸåŠ¨ç”» */
        .card.matched {
            animation: match 0.6s ease-in-out;
        }

        /* åŒ¹é…å¤±è´¥éœ‡åŠ¨åŠ¨ç”» */
        .card.error {
            animation: shake 0.5s ease-in-out;
        }

        /* å¡ç‰‡æ­£åé¢é€šç”¨æ ·å¼ */
        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden; /* éšè—èƒŒé¢ï¼ˆç¿»è½¬åä¸å¯è§ï¼‰ */
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px;
            text-align: center;
        }

        /* å¡ç‰‡èƒŒé¢æ ·å¼ */
        .card-back {
            background: var(--primary);
            color: var(--text-light);
            font-size: 1.1rem;
            font-weight: 500;
        }

        /* å¡ç‰‡æ­£é¢æ ·å¼ï¼ˆé»˜è®¤ç¿»è½¬éšè—ï¼‰ */
        .card-front {
            background: var(--card-bg);
            color: var(--text-dark);
            font-size: 1.4rem;
            transform: rotateY(180deg); /* åˆå§‹ç¿»è½¬åˆ°èƒŒé¢ */
        }

        /* åŒ¹é…æˆåŠŸåæ­£é¢æ ·å¼ */
        .card.matched .card-front {
            background: var(--success);
            color: var(--text-light);
        }

        /* åŒ¹é…æˆåŠŸå›¾æ ‡ï¼ˆé»˜è®¤éšè—ï¼‰ */
        .match-icon {
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 1rem;
            display: none;
        }

        .card.matched .match-icon {
            display: block;
        }

        /* æ¸¸æˆç»“æŸå¼¹çª—æ ·å¼ */
        .game-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .game-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .result-modal {
            background: var(--card-bg);
            padding: 30px 25px;
            border-radius: 10px;
            width: 90%;
            max-width: 450px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .result-title {
            color: var(--success);
            font-size: 1.6rem;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .result-stats {
            margin-bottom: 25px;
            text-align: left;
            padding-left: 15px;
        }

        .result-stat {
            margin: 12px 0;
            font-size: 1.05rem;
        }

        .best-record {
            color: var(--primary);
            font-weight: 600;
        }

        .result-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .result-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: var(--transition);
        }

        .play-again-btn {
            background: var(--primary);
            color: var(--text-light);
        }

        .play-again-btn:hover {
            background: #1d4ed8;
        }

        .share-btn {
            background: var(--success);
            color: var(--text-light);
        }

        .share-btn:hover {
            background: #059669;
        }

        /* åŠ¨ç”»å…³é”®å¸§å®šä¹‰ */
        @keyframes match {
            0%, 100% { transform: rotateY(180deg) scale(1); }
            50% { transform: rotateY(180deg) scale(1.08); } /* åŒ¹é…æ—¶è½»å¾®æ”¾å¤§ */
        }

        @keyframes shake {
            0%, 100% { transform: rotateY(180deg) translateX(0); }
            20% { transform: rotateY(180deg) translateX(-8px); }
            40% { transform: rotateY(180deg) translateX(8px); }
            60% { transform: rotateY(180deg) translateX(-4px); }
            80% { transform: rotateY(180deg) translateX(4px); } /* å¤±è´¥æ—¶å·¦å³éœ‡åŠ¨ */
        }
    </style>
</head>
<body>
    <!-- æ¸¸æˆå¤´éƒ¨ï¼šæ ‡é¢˜ã€ç»Ÿè®¡ã€æ§åˆ¶æŒ‰é’® -->
    <div class="game-header">
        <h1 class="game-title">HSK6 æˆè¯­å¯¹å¯¹ç¢°</h1>
        
        <!-- æ¸¸æˆæ•°æ®ç»Ÿè®¡ï¼šæ—¶é—´ã€æ­¥æ•°ã€å·²åŒ¹é…æ•° -->
        <div class="game-stats">
            <div class="stat-item">
                <span class="stat-icon">â±ï¸</span>
                <span>æ—¶é—´: <span id="time">00:00</span></span>
            </div>
            <div class="stat-item">
                <span class="stat-icon">ğŸ‘£</span>
                <span>æ­¥æ•°: <span id="moves">0</span></span>
            </div>
            <div class="stat-item">
                <span class="stat-icon">âœ…</span>
                <span>åŒ¹é…: <span id="matches">0</span>/12</span>
            </div>
        </div>
        
        <!-- é‡æ–°å¼€å§‹æŒ‰é’® -->
        <div class="game-controls">
            <button class="reset-btn" id="reset-btn">é‡æ–°å¼€å§‹</button>
        </div>
    </div>

    <!-- å¡ç‰‡å®¹å™¨ï¼šåŠ¨æ€ç”Ÿæˆ24ä¸ªå¡ç‰‡ -->
    <div class="game-container">
        <div class="card-grid" id="card-grid"></div>
    </div>

    <!-- æ¸¸æˆç»“æŸå¼¹çª—ï¼šç»“æœå±•ç¤ºã€é‡ç©ã€åˆ†äº« -->
    <div class="game-overlay" id="game-overlay">
        <div class="result-modal">
            <h2 class="result-title">æ­å–œå®ŒæˆæŒ‘æˆ˜!</h2>
            <div class="result-stats">
                <div class="result-stat">æ€»ç”¨æ—¶: <span id="result-time">00:00</span></div>
                <div class="result-stat">æ€»æ­¥æ•°: <span id="result-moves">0</span></div>
                <div class="result-stat best-record">æœ€ä½³è®°å½•: <span id="best-record">--</span></div>
            </div>
            <div class="result-buttons">
                <button class="result-btn play-again-btn" id="play-again-btn">å†ç©ä¸€æ¬¡</button>
                <button class="result-btn share-btn" id="share-btn">å¤åˆ¶æˆç»©</button>
            </div>
        </div>
    </div>

    <script>
        // 1. æˆè¯­æ•°æ®ç»“æ„ï¼šå®šä¹‰12ä¸ªHSK6æˆè¯­åŠæ‹†åˆ†è§„åˆ™
        const idioms = [
            { id: 1, part1: "éš¾èƒ½", part2: "å¯è´µ", full: "éš¾èƒ½å¯è´µ" },
            { id: 2, part1: "æ— å¯", part2: "å¥ˆä½•", full: "æ— å¯å¥ˆä½•" },
            { id: 3, part1: "å„æŠ’", part2: "å·±è§", full: "å„æŠ’å·±è§" },
            { id: 4, part1: "ä¸å¯", part2: "æ€è®®", full: "ä¸å¯æ€è®®" },
            { id: 5, part1: "åˆ»ä¸", part2: "å®¹ç¼“", full: "åˆ»ä¸å®¹ç¼“" },
            { id: 6, part1: "æœ›å°˜", part2: "è«åŠ", full: "æœ›å°˜è«åŠ" },
            { id: 7, part1: "äº‹ä¸", part2: "æ„¿è¿", full: "äº‹ä¸æ„¿è¿" },
            { id: 8, part1: "è¨€ç®€", part2: "æ„èµ…", full: "è¨€ç®€æ„èµ…" },
            { id: 9, part1: "å‹ƒç„¶", part2: "å¤§æ€’", full: "å‹ƒç„¶å¤§æ€’" },
            { id: 10, part1: "æ©è€³", part2: "ç›—é“ƒ", full: "æ©è€³ç›—é“ƒ" },
            { id: 11, part1: "è‡ªç›¸", part2: "çŸ›ç›¾", full: "è‡ªç›¸çŸ›ç›¾" },
            { id: 12, part1: "æ¨é™ˆ", part2: "å‡ºæ–°", full: "æ¨é™ˆå‡ºæ–°" }
        ];

        // 2. æ¸¸æˆçŠ¶æ€ç®¡ç†ï¼šå­˜å‚¨æ ¸å¿ƒæ¸¸æˆæ•°æ®
        const gameState = {
            flippedCards: [],    // å½“å‰ç¿»è½¬çš„å¡ç‰‡ï¼ˆæœ€å¤š2å¼ ï¼‰
            matchedPairs: 0,     // å·²åŒ¹é…çš„å¯¹æ•°
            moves: 0,            // æ€»æ­¥æ•°
            time: 0,             // æ€»æ—¶é—´ï¼ˆç§’ï¼‰
            timerInterval: null, // è®¡æ—¶å™¨å®šæ—¶å™¨
            isProcessing: false, // æ˜¯å¦å¤„äºåŒ¹é…åˆ¤å®šä¸­ï¼ˆé˜²æ­¢é‡å¤ç‚¹å‡»ï¼‰
            bestRecord: JSON.parse(localStorage.getItem('hskIdiomBest')) || { time: Infinity, moves: Infinity } // æœ¬åœ°å­˜å‚¨æœ€ä½³è®°å½•
        };

        // 3. DOMå…ƒç´ è·å–ï¼šç¼“å­˜å¸¸ç”¨å…ƒç´ ï¼Œé¿å…é‡å¤æŸ¥è¯¢
        const elements = {
            cardGrid: document.getElementById('card-grid'),
            timeDisplay: document.getElementById('time'),
            movesDisplay: document.getElementById('moves'),
            matchesDisplay: document.getElementById('matches'),
            resetBtn: document.getElementById('reset-btn'),
            gameOverlay: document.getElementById('game-overlay'),
            resultTime: document.getElementById('result-time'),
            resultMoves: document.getElementById('result-moves'),
            bestRecord: document.getElementById('best-record'),
            playAgainBtn: document.getElementById('play-again-btn'),
            shareBtn: document.getElementById('share-btn')
        };

        // 4. å·¥å…·å‡½æ•°ï¼šæ—¶é—´æ ¼å¼åŒ–ï¼ˆç§’ â†’ åˆ†:ç§’ï¼‰
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60).toString().padStart(2, '0');
            const secs = (seconds % 60).toString().padStart(2, '0');
            return `${mins}:${secs}`;
        }

        // 5. æ¸¸æˆæ ¸å¿ƒé€»è¾‘ï¼šæ›´æ–°ç»Ÿè®¡æ•°æ®æ˜¾ç¤º
        function updateStats() {
            elements.timeDisplay.textContent = formatTime(gameState.time);
            elements.movesDisplay.textContent = gameState.moves;
            elements.matchesDisplay.textContent = gameState.matchedPairs;
        }

        // 6. æ¸¸æˆæ ¸å¿ƒé€»è¾‘ï¼šå¼€å§‹è®¡æ—¶å™¨
        function startTimer() {
            // æ¸…é™¤å·²æœ‰å®šæ—¶å™¨ï¼ˆé˜²æ­¢é‡å¤ï¼‰
            if (gameState.timerInterval) clearInterval(gameState.timerInterval);
            // æ¯ç§’æ›´æ–°æ—¶é—´
            gameState.timerInterval = setInterval(() => {
                gameState.time++;
                updateStats();
            }, 1000);
        }

        // 7. æ¸¸æˆæ ¸å¿ƒé€»è¾‘ï¼šæ£€æŸ¥ä¸¤å¼ å¡ç‰‡æ˜¯å¦åŒ¹é…
        function checkMatch() {
            const [card1, card2] = gameState.flippedCards;
            const card1Id = card1.dataset.id.split('-')[0]; // è·å–å¡ç‰‡å¯¹åº”çš„æˆè¯­IDï¼ˆå¦‚"1-1" â†’ "1"ï¼‰
            const card2Id = card2.dataset.id.split('-')[0];

            // åˆ¤å®šè§„åˆ™ï¼šæˆè¯­IDç›¸åŒ â†’ åŒ¹é…æˆåŠŸ
            if (card1Id === card2Id) {
                // åŒ¹é…æˆåŠŸï¼šæ·»åŠ åŒ¹é…æ ·å¼ï¼Œæ ‡è®°ä¸ºä¸å¯ç‚¹å‡»
                card1.classList.add('matched');
                card2.classList.add('matched');
                card1.style.pointerEvents = 'none';
                card2.style.pointerEvents = 'none';
                // æ›´æ–°åŒ¹é…æ•°
                gameState.matchedPairs++;
                // é‡ç½®ç¿»è½¬å¡ç‰‡æ•°ç»„
                gameState.flippedCards = [];
                gameState.isProcessing = false;
                // æ£€æŸ¥æ˜¯å¦å…¨éƒ¨åŒ¹é…å®Œæˆ
                if (gameState.matchedPairs === 12) endGame();
            } else {
                // åŒ¹é…å¤±è´¥ï¼š
